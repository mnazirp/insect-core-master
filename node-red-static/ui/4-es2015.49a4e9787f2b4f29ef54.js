(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{Vo00:function(t,e,i){"use strict";i.r(e),i.d(e,"FormHistoryModule",(function(){return Ct}));var n=i("ofXK"),a=i("tyNb");const o={lang:"en",data:{FORM_HISTORY:{SUBMISSION_HISTORY:"Form Submission History",SUBMIT_DATE:"Submission Date",LINE:"Production Line",FORM:"Workstation Form",SEARCH:"Search",SEARCH_FOR_FORM:"Search for Form",START_DATE:"Start Date",END_DATE:"End Date",DATE_RANGE:"Submission Date Range"}}},c={lang:"my",data:{FORM_HISTORY:{SUBMISSION_HISTORY:"Sejarah Penyerahan Borang",SUBMIT_DATE:"Tarikh penyerahan",LINE:"Barisan pengeluaran",FORM:"Borang Stesen Kerja",SEARCH:"Cari",SEARCH_FOR_FORM:"Mencari Borang",START_DATE:"Tarikh mula",END_DATE:"Tarikh tamat",DATE_RANGE:"Julat Tarikh Penghantaran"}}};var s=i("fXoL"),r=i("bTqV"),l=i("d3UM"),p=i("Qu3c"),g=i("8LU1"),d=i("XNiG"),h=i("FKr1"),b=i("kmnG");function u(t,e){if(1&t&&(s.Ub(0,"mat-option",19),s.Lc(1),s.Tb()),2&t){const t=e.$implicit;s.nc("value",t),s.Cb(1),s.Nc(" ",t," ")}}function m(t,e){if(1&t){const t=s.Vb();s.Ub(0,"mat-form-field",16),s.Ub(1,"mat-select",17),s.cc("selectionChange",(function(e){return s.yc(t),s.gc(2)._changePageSize(e.value)})),s.Jc(2,u,2,2,"mat-option",18),s.Tb(),s.Tb()}if(2&t){const t=s.gc(2);s.nc("appearance",t._formFieldAppearance)("color",t.color),s.Cb(1),s.nc("value",t.pageSize)("disabled",t.disabled)("aria-label",t._intl.itemsPerPageLabel),s.Cb(1),s.nc("ngForOf",t._displayedPageSizeOptions)}}function f(t,e){if(1&t&&(s.Ub(0,"div",20),s.Lc(1),s.Tb()),2&t){const t=s.gc(2);s.Cb(1),s.Mc(t.pageSize)}}function y(t,e){if(1&t&&(s.Ub(0,"div",12),s.Ub(1,"div",13),s.Lc(2),s.Tb(),s.Jc(3,m,3,6,"mat-form-field",14),s.Jc(4,f,2,1,"div",15),s.Tb()),2&t){const t=s.gc();s.Cb(2),s.Nc(" ",t._intl.itemsPerPageLabel," "),s.Cb(1),s.nc("ngIf",t._displayedPageSizeOptions.length>1),s.Cb(1),s.nc("ngIf",t._displayedPageSizeOptions.length<=1)}}function T(t,e){if(1&t){const t=s.Vb();s.Ub(0,"button",21),s.cc("click",(function(){return s.yc(t),s.gc().firstPage()})),s.fc(),s.Ub(1,"svg",7),s.Pb(2,"path",22),s.Tb(),s.Tb()}if(2&t){const t=s.gc();s.nc("matTooltip",t._intl.firstPageLabel)("matTooltipDisabled",t._previousButtonsDisabled())("matTooltipPosition","above")("disabled",t._previousButtonsDisabled()),s.Db("aria-label",t._intl.firstPageLabel)}}function S(t,e){if(1&t){const t=s.Vb();s.fc(),s.ec(),s.Ub(0,"button",23),s.cc("click",(function(){return s.yc(t),s.gc().lastPage()})),s.fc(),s.Ub(1,"svg",7),s.Pb(2,"path",24),s.Tb(),s.Tb()}if(2&t){const t=s.gc();s.nc("matTooltip",t._intl.lastPageLabel)("matTooltipDisabled",t._nextButtonsDisabled())("matTooltipPosition","above")("disabled",t._nextButtonsDisabled()),s.Db("aria-label",t._intl.lastPageLabel)}}let x=(()=>{class t{constructor(){this.changes=new d.a,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(t,e,i)=>{if(0==i||0==e)return"0 of "+i;const n=t*e;return`${n+1} \u2013 ${n<(i=Math.max(i,0))?Math.min(n+e,i):n+e} of ${i}`}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Object(s.Kb)({factory:function(){return new t},token:t,providedIn:"root"}),t})();const _={provide:x,deps:[[new s.C,new s.L,x]],useFactory:function(t){return t||new x}},w=new s.s("MAT_PAGINATOR_DEFAULT_OPTIONS");class C{}const v=Object(h.A)(Object(h.C)(C));let O=(()=>{class t extends v{constructor(t,e,i){if(super(),this._intl=t,this._changeDetectorRef=e,this._pageIndex=0,this._length=0,this._pageSizeOptions=[],this._hidePageSize=!1,this._showFirstLastButtons=!1,this.page=new s.o,this._intlChanges=t.changes.subscribe(()=>this._changeDetectorRef.markForCheck()),i){const{pageSize:t,pageSizeOptions:e,hidePageSize:n,showFirstLastButtons:a,formFieldAppearance:o}=i;null!=t&&(this._pageSize=t),null!=e&&(this._pageSizeOptions=e),null!=n&&(this._hidePageSize=n),null!=a&&(this._showFirstLastButtons=a),null!=o&&(this._formFieldAppearance=o)}}get pageIndex(){return this._pageIndex}set pageIndex(t){this._pageIndex=Math.max(Object(g.f)(t),0),this._changeDetectorRef.markForCheck()}get length(){return this._length}set length(t){this._length=Object(g.f)(t),this._changeDetectorRef.markForCheck()}get pageSize(){return this._pageSize}set pageSize(t){this._pageSize=Math.max(Object(g.f)(t),0),this._updateDisplayedPageSizeOptions()}get pageSizeOptions(){return this._pageSizeOptions}set pageSizeOptions(t){this._pageSizeOptions=(t||[]).map(t=>Object(g.f)(t)),this._updateDisplayedPageSizeOptions()}get hidePageSize(){return this._hidePageSize}set hidePageSize(t){this._hidePageSize=Object(g.c)(t)}get showFirstLastButtons(){return this._showFirstLastButtons}set showFirstLastButtons(t){this._showFirstLastButtons=Object(g.c)(t)}ngOnInit(){this._initialized=!0,this._updateDisplayedPageSizeOptions(),this._markInitialized()}ngOnDestroy(){this._intlChanges.unsubscribe()}nextPage(){if(!this.hasNextPage())return;const t=this.pageIndex;this.pageIndex++,this._emitPageEvent(t)}previousPage(){if(!this.hasPreviousPage())return;const t=this.pageIndex;this.pageIndex--,this._emitPageEvent(t)}firstPage(){if(!this.hasPreviousPage())return;const t=this.pageIndex;this.pageIndex=0,this._emitPageEvent(t)}lastPage(){if(!this.hasNextPage())return;const t=this.pageIndex;this.pageIndex=this.getNumberOfPages()-1,this._emitPageEvent(t)}hasPreviousPage(){return this.pageIndex>=1&&0!=this.pageSize}hasNextPage(){const t=this.getNumberOfPages()-1;return this.pageIndex<t&&0!=this.pageSize}getNumberOfPages(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}_changePageSize(t){const e=this.pageIndex;this.pageIndex=Math.floor(this.pageIndex*this.pageSize/t)||0,this.pageSize=t,this._emitPageEvent(e)}_nextButtonsDisabled(){return this.disabled||!this.hasNextPage()}_previousButtonsDisabled(){return this.disabled||!this.hasPreviousPage()}_updateDisplayedPageSizeOptions(){this._initialized&&(this.pageSize||(this._pageSize=0!=this.pageSizeOptions.length?this.pageSizeOptions[0]:50),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),-1===this._displayedPageSizeOptions.indexOf(this.pageSize)&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((t,e)=>t-e),this._changeDetectorRef.markForCheck())}_emitPageEvent(t){this.page.emit({previousPageIndex:t,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(x),s.Ob(s.h),s.Ob(w,8))},t.\u0275cmp=s.Ib({type:t,selectors:[["mat-paginator"]],hostAttrs:[1,"mat-paginator"],inputs:{disabled:"disabled",pageIndex:"pageIndex",length:"length",pageSize:"pageSize",pageSizeOptions:"pageSizeOptions",hidePageSize:"hidePageSize",showFirstLastButtons:"showFirstLastButtons",color:"color"},outputs:{page:"page"},exportAs:["matPaginator"],features:[s.zb],decls:14,vars:14,consts:[[1,"mat-paginator-outer-container"],[1,"mat-paginator-container"],["class","mat-paginator-page-size",4,"ngIf"],[1,"mat-paginator-range-actions"],[1,"mat-paginator-range-label"],["mat-icon-button","","type","button","class","mat-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-previous",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["viewBox","0 0 24 24","focusable","false",1,"mat-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-next",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button","class","mat-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],[1,"mat-paginator-page-size"],[1,"mat-paginator-page-size-label"],["class","mat-paginator-page-size-select",3,"appearance","color",4,"ngIf"],["class","mat-paginator-page-size-value",4,"ngIf"],[1,"mat-paginator-page-size-select",3,"appearance","color"],[3,"value","disabled","aria-label","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mat-paginator-page-size-value"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(t,e){1&t&&(s.Ub(0,"div",0),s.Ub(1,"div",1),s.Jc(2,y,5,3,"div",2),s.Ub(3,"div",3),s.Ub(4,"div",4),s.Lc(5),s.Tb(),s.Jc(6,T,3,5,"button",5),s.Ub(7,"button",6),s.cc("click",(function(){return e.previousPage()})),s.fc(),s.Ub(8,"svg",7),s.Pb(9,"path",8),s.Tb(),s.Tb(),s.ec(),s.Ub(10,"button",9),s.cc("click",(function(){return e.nextPage()})),s.fc(),s.Ub(11,"svg",7),s.Pb(12,"path",10),s.Tb(),s.Tb(),s.Jc(13,S,3,5,"button",11),s.Tb(),s.Tb(),s.Tb()),2&t&&(s.Cb(2),s.nc("ngIf",!e.hidePageSize),s.Cb(3),s.Nc(" ",e._intl.getRangeLabel(e.pageIndex,e.pageSize,e.length)," "),s.Cb(1),s.nc("ngIf",e.showFirstLastButtons),s.Cb(1),s.nc("matTooltip",e._intl.previousPageLabel)("matTooltipDisabled",e._previousButtonsDisabled())("matTooltipPosition","above")("disabled",e._previousButtonsDisabled()),s.Db("aria-label",e._intl.previousPageLabel),s.Cb(3),s.nc("matTooltip",e._intl.nextPageLabel)("matTooltipDisabled",e._nextButtonsDisabled())("matTooltipPosition","above")("disabled",e._nextButtonsDisabled()),s.Db("aria-label",e._intl.nextPageLabel),s.Cb(3),s.nc("ngIf",e.showFirstLastButtons))},directives:[n.t,r.b,p.a,b.c,l.a,n.s,h.o],styles:[".mat-paginator{display:block}.mat-paginator-outer-container{display:flex}.mat-paginator-container{display:flex;align-items:center;justify-content:flex-end;padding:0 8px;flex-wrap:wrap-reverse;width:100%}.mat-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-paginator-page-size{margin-right:0;margin-left:8px}.mat-paginator-page-size-label{margin:0 4px}.mat-paginator-page-size-select{margin:6px 4px 0 4px;width:56px}.mat-paginator-page-size-select.mat-form-field-appearance-outline{width:64px}.mat-paginator-page-size-select.mat-form-field-appearance-fill{width:64px}.mat-paginator-range-label{margin:0 32px 0 24px}.mat-paginator-range-actions{display:flex;align-items:center}.mat-paginator-icon{width:28px;fill:currentColor}[dir=rtl] .mat-paginator-icon{transform:rotate(180deg)}\n"],encapsulation:2,changeDetection:0}),t})(),P=(()=>{class t{}return t.\u0275mod=s.Mb({type:t}),t.\u0275inj=s.Lb({factory:function(e){return new(e||t)},providers:[_],imports:[[n.c,r.c,l.b,p.b]]}),t})();var I=i("1yaQ"),L=i("gPJw"),M=i("tk/3"),z=i("4WDQ");let D=(()=>{class t{constructor(t,e){this.http=t,this.global=e}getSubmissionHistory(t){let e=new M.d;return t&&(e=e.append("pageSize",t.pageSize),e=e.append("page",t.page),t.startDate&&(e=e.append("date.greaterOrEqualThan",t.startDate)),t.endDate&&(e=e.append("date.lessOrEqualThan",t.endDate)),t.form&&(e=e.append("forms.equals",t.form)),t.productionLine&&(e=e.append("productionLine.equals",t.productionLine)),t.templateType&&(e=e.append("templateType",t.templateType))),console.log(e),this.http.get(`/api/${this.global.tenant}/forms/history`,{params:e})}}return t.\u0275fac=function(e){return new(e||t)(s.Yb(M.b),s.Yb(z.a))},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var F=i("7Wwi"),k=i("hw3O"),U=i("EwFO"),R=i("XiUz"),E=i("NFeN"),A=i("7EHt"),N=i("3Pt+"),B=i("/1cH"),H=i("iadO"),J=i("+0xr"),Y=i("sYmb");function $(t,e){if(1&t&&(s.Ub(0,"span"),s.Lc(1),s.Tb()),2&t){const t=s.gc().$implicit;s.Cb(1),s.Nc("(",t.line,")")}}function j(t,e){if(1&t&&(s.Ub(0,"mat-option",27),s.Lc(1),s.Jc(2,$,2,1,"span",28),s.Tb()),2&t){const t=e.$implicit;s.nc("value",t),s.Cb(1),s.Nc(" ",t.form," "),s.Cb(1),s.nc("ngIf",t.line)}}function V(t,e){1&t&&(s.Ub(0,"mat-header-cell",41),s.Lc(1),s.hc(2,"translate"),s.Tb()),2&t&&(s.Cb(1),s.Mc(s.ic(2,1,"FORM_HISTORY.SUBMIT_DATE")))}function q(t,e){if(1&t){const t=s.Vb();s.Ub(0,"mat-cell"),s.Ub(1,"p",42),s.cc("click",(function(){s.yc(t);const i=e.$implicit;return s.gc(2).editForm(i)})),s.Lc(2),s.hc(3,"date"),s.Tb(),s.Tb()}if(2&t){const t=e.$implicit;s.Cb(2),s.Nc(" ",s.jc(3,1,t.submission_timestamp,"dd-MMM-yyyy, HH:mm:ss")," ")}}function W(t,e){1&t&&(s.Ub(0,"mat-header-cell",41),s.Lc(1),s.hc(2,"translate"),s.Tb()),2&t&&(s.Cb(1),s.Mc(s.ic(2,1,"FORM_HISTORY.LINE")))}function G(t,e){if(1&t){const t=s.Vb();s.Ub(0,"mat-cell"),s.Ub(1,"p",42),s.cc("click",(function(){s.yc(t);const i=e.$implicit;return s.gc(2).editForm(i)})),s.Lc(2),s.Tb(),s.Tb()}if(2&t){const t=e.$implicit;s.Cb(2),s.Nc(" ",t.productionLine," ")}}function K(t,e){1&t&&(s.Ub(0,"mat-header-cell",41),s.Lc(1),s.hc(2,"translate"),s.Tb()),2&t&&(s.Cb(1),s.Mc(s.ic(2,1,"FORM_HISTORY.FORM")))}function Q(t,e){if(1&t){const t=s.Vb();s.Ub(0,"mat-cell"),s.Ub(1,"p",42),s.cc("click",(function(){s.yc(t);const i=e.$implicit;return s.gc(2).editForm(i)})),s.Lc(2),s.Tb(),s.Tb()}if(2&t){const t=e.$implicit;s.Cb(2),s.Nc(" ",t.workstationForm," ")}}function X(t,e){1&t&&s.Pb(0,"mat-header-row")}function Z(t,e){if(1&t){const t=s.Vb();s.Ub(0,"mat-row",43),s.cc("click",(function(){s.yc(t);const i=e.index,n=s.gc(2);return n.highlight(i),n.selectFormByIndex(n.selectedRowIndex)}))("keydown.enter",(function(){s.yc(t);const e=s.gc(2);return e.selectFormByIndex(e.selectedRowIndex)}))("keydown.arrowdown",(function(){s.yc(t);const e=s.gc(2);return e.arrowDownEvent(e.selectedRowIndex)}))("keydown.arrowup",(function(){s.yc(t);const e=s.gc(2);return e.arrowUpEvent(e.selectedRowIndex)})),s.Tb()}if(2&t){const t=e.index,i=s.gc(2);s.Gc("background",i.selectedRowIndex==t?"lightgray":""),s.nc("tabindex",0==t?0:-1)}}function tt(t,e){1&t&&(s.Ub(0,"div"),s.Lc(1,"No data"),s.Tb())}const et=function(){return[5,10,20]};function it(t,e){if(1&t){const t=s.Vb();s.Ub(0,"div",29),s.Ub(1,"mat-table",30,31),s.cc("matSortChange",(function(e){return s.yc(t),s.gc().sortData(e)}))("focusin",(function(){return s.yc(t),s.gc().highlight(0)}))("focusout",(function(){return s.yc(t),s.gc().selectedRowIndex=null})),s.Sb(3,32),s.Jc(4,V,3,3,"mat-header-cell",33),s.Jc(5,q,4,4,"mat-cell",34),s.Rb(),s.Sb(6,35),s.Jc(7,W,3,3,"mat-header-cell",33),s.Jc(8,G,3,1,"mat-cell",34),s.Rb(),s.Sb(9,36),s.Jc(10,K,3,3,"mat-header-cell",33),s.Jc(11,Q,3,1,"mat-cell",34),s.Rb(),s.Jc(12,X,1,0,"mat-header-row",37),s.Jc(13,Z,1,3,"mat-row",38),s.Tb(),s.Jc(14,tt,2,0,"div",28),s.Ub(15,"mat-paginator",39,40),s.cc("page",(function(e){return s.yc(t),s.gc().onPageChange(e)})),s.Tb(),s.Tb()}if(2&t){const t=s.gc();s.Cb(1),s.nc("dataSource",t.dataSource),s.Cb(11),s.nc("matHeaderRowDef",t.displayedColumns),s.Cb(1),s.nc("matRowDefColumns",t.displayedColumns),s.Cb(1),s.nc("ngIf",0===t.dataSource.length),s.Cb(1),s.nc("pageIndex",t.page)("length",t.totalSize)("pageSize",t.pageSize)("pageSizeOptions",s.pc(8,et))}}function nt(t,e){if(1&t&&(s.Ub(0,"mat-header-cell",41),s.Lc(1),s.Tb()),2&t){const t=s.gc().$implicit;s.Cb(1),s.Mc(t.label)}}function at(t,e){if(1&t){const t=s.Vb();s.Ub(0,"p",50),s.cc("click",(function(){s.yc(t);const e=s.gc(2).$implicit;return s.gc(3).editForm(e)})),s.Lc(1),s.hc(2,"date"),s.Tb()}if(2&t){const t=s.gc(2).$implicit;s.Cb(1),s.Pc(" ",s.jc(2,3,t.submission_timestamp,"dd-MMM-yyyy, HH:mm:ss")," , ",t.productionLine," , ",t.workstationForm," ")}}function ot(t,e){if(1&t){const t=s.Vb();s.Ub(0,"p",42),s.cc("click",(function(){s.yc(t);const e=s.gc(2).$implicit;return s.gc(3).editForm(e)})),s.Lc(1),s.hc(2,"date"),s.Tb()}if(2&t){const t=s.gc().$implicit,e=s.gc().$implicit;s.Cb(1),s.Nc(" ",s.jc(2,1,e[t],"dd-MMM-yyyy, HH:mm:ss")," ")}}function ct(t,e){if(1&t){const t=s.Vb();s.Ub(0,"p",42),s.cc("click",(function(){s.yc(t);const e=s.gc(3).$implicit;return s.gc(3).editForm(e)})),s.Lc(1),s.hc(2,"slice"),s.Tb()}if(2&t){const t=s.gc(2).$implicit,e=s.gc().$implicit;s.Cb(1),s.Nc(" ",s.kc(2,1,e[t],0,50),"... ")}}function st(t,e){if(1&t&&(s.Ub(0,"div"),s.Jc(1,ct,3,5,"p",49),s.Tb()),2&t){const t=s.gc().$implicit;s.Cb(1),s.nc("ngIf",0==t.includes("timestamp"))}}function rt(t,e){if(1&t){const t=s.Vb();s.Ub(0,"p",42),s.cc("click",(function(){s.yc(t);const e=s.gc(3).$implicit;return s.gc(3).editForm(e)})),s.Lc(1),s.Tb()}if(2&t){const t=s.gc(2).$implicit,e=s.gc().$implicit;s.Cb(1),s.Nc(" ",e[t]," ")}}function lt(t,e){if(1&t&&(s.Ub(0,"div"),s.Jc(1,rt,2,1,"p",49),s.Tb()),2&t){const t=s.gc().$implicit;s.Cb(1),s.nc("ngIf",0==t.includes("timestamp"))}}function pt(t,e){if(1&t&&(s.Ub(0,"div"),s.Jc(1,at,3,6,"p",48),s.Jc(2,ot,3,4,"p",49),s.Jc(3,st,2,1,"div",28),s.Jc(4,lt,2,1,"div",28),s.Tb()),2&t){const t=e.$implicit,i=s.gc().$implicit,n=s.gc(3);s.Cb(1),s.nc("ngIf",1==t.includes("common_field")),s.Cb(1),s.nc("ngIf",1==t.includes("timestamp")),s.Cb(1),s.nc("ngIf",n.isLengthMoreThan(i[t],t)),s.Cb(1),s.nc("ngIf",n.isLengthLessThan(i[t],t))}}function gt(t,e){if(1&t&&(s.Ub(0,"mat-cell"),s.Jc(1,pt,5,4,"div",47),s.Tb()),2&t){const t=s.gc().$implicit;s.Cb(1),s.nc("ngForOf",t.keys)}}function dt(t,e){1&t&&(s.Sb(0,46),s.Jc(1,nt,2,1,"mat-header-cell",33),s.Jc(2,gt,2,1,"mat-cell",34),s.Rb()),2&t&&s.nc("matColumnDef",e.$implicit.keys[0])}function ht(t,e){1&t&&s.Pb(0,"mat-header-row")}function bt(t,e){if(1&t){const t=s.Vb();s.Ub(0,"mat-row",43),s.cc("click",(function(){s.yc(t);const i=e.index,n=s.gc(2);return n.highlight(i),n.selectFormByIndex(n.selectedRowIndex)}))("keydown.enter",(function(){s.yc(t);const e=s.gc(2);return e.selectFormByIndex(e.selectedRowIndex)}))("keydown.arrowdown",(function(){s.yc(t);const e=s.gc(2);return e.arrowDownEvent(e.selectedRowIndex)}))("keydown.arrowup",(function(){s.yc(t);const e=s.gc(2);return e.arrowUpEvent(e.selectedRowIndex)})),s.Tb()}if(2&t){const t=e.index,i=s.gc(2);s.Gc("background",i.selectedRowIndex==t?"lightgray":""),s.nc("tabindex",0==t?0:-1)}}function ut(t,e){1&t&&(s.Ub(0,"div"),s.Lc(1,"No data"),s.Tb())}function mt(t,e){if(1&t){const t=s.Vb();s.Ub(0,"div",29),s.Ub(1,"mat-table",30,31),s.cc("matSortChange",(function(e){return s.yc(t),s.gc().sortData(e)}))("focusin",(function(){return s.yc(t),s.gc().highlight(0)}))("focusout",(function(){return s.yc(t),s.gc().selectedRowIndex=null})),s.Jc(3,dt,3,1,"ng-container",44),s.Jc(4,ht,1,0,"mat-header-row",37),s.Jc(5,bt,1,3,"mat-row",38),s.Tb(),s.Jc(6,ut,2,0,"div",28),s.Ub(7,"mat-paginator",45),s.cc("page",(function(e){return s.yc(t),s.gc().onPageChange(e)})),s.Tb(),s.Tb()}if(2&t){const t=s.gc();s.Cb(1),s.nc("dataSource",t.dataSource),s.Cb(2),s.nc("ngForOf",t.dynamicColumn),s.Cb(1),s.nc("matHeaderRowDef",t.dynamicDisplayedColumn),s.Cb(1),s.nc("matRowDefColumns",t.dynamicDisplayedColumn),s.Cb(1),s.nc("ngIf",0===t.dataSource.length),s.Cb(1),s.nc("length",t.totalSize)("pageSize",t.pageSize)("pageSizeOptions",s.pc(8,et))}}const ft={parse:{dateInput:"LL"},display:{dateInput:"DD/MM/YYYY",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}};let yt=(()=>{class t{constructor(t,e,i,n,a,s){this._fuseTranslationLoaderService=t,this._service=e,this.formSelectionService=i,this.router=n,this.formService=a,this.activatedRoute=s,this.totalSize=0,this.displayedColumns=["date","line","form"],this.dynamicColumn=[],this.dataSource=[],this.res=[],this.pageSize=10,this.page=0,this.filteredForm=[],this.forms=[],this.dynamicTable=!1,this.dynamicDisplayedColumn=[],this._fuseTranslationLoaderService.loadTranslations(o,c)}get hasTemplateType(){return!!this.activatedRoute.snapshot.data.templateType}get templateType(){return this.activatedRoute.snapshot.data.templateType}get templateTypeDevice(){return"device"===this.activatedRoute.snapshot.data.templateType}ngOnInit(){this.getForms(),this.fetch()}getForms(){let t={};this.hasTemplateType&&(t.templateType=this.templateType),this.formSelectionService.getForms(t).subscribe(t=>{this.apiOutput=t,this.addId()})}addId(){var t=1;for(let e of this.apiOutput){let i=e;i.id=t,t+=1,this.forms.push(i)}this.filteredForm=this.forms}filterMyOptions(t){this.selectedForm=void 0,this.filteredForm=this.forms.filter(e=>e.id.toString().indexOf(t)>-1||e.form.toLocaleLowerCase().indexOf(t)>-1)}displayWith(t){return t?t.form:""}selectForm(t){this.selectedForm=t}fetch(){let t={};t.page=this.page,t.pageSize=this.pageSize,this.queryStartDate&&(t.startDate=this.queryStartDate.startOf("day").toISOString()),this.queryEndDate&&(t.endDate=this.queryEndDate.endOf("day").toISOString()),this.selectedForm&&(t.form=this.selectedForm.form,t.productionLine=this.selectedForm.line),this.hasTemplateType&&(t.templateType=this.templateType),console.log(t),this._service.getSubmissionHistory(t).subscribe(t=>{if(this.totalSize=t.totalElement,this.res=t.data,this.dataSource=this.res.slice(),this.dynamicDisplayedColumn=[],null!=this.selectedForm)if(t.dynamicColumn){this.dynamicColumn=t.dynamicColumn;for(var e=0;e<this.dynamicColumn.length;e++)this.dynamicDisplayedColumn.push(this.dynamicColumn[e].keys[0]);this.dynamicTable=!0}else this.dynamicTable=!1;else this.dynamicTable=!1})}isLengthMoreThan(t,e){if("common_field"!=e&&t)return t.length>50}isLengthLessThan(t,e){if("common_field"!=e&&t)return t.length<50}onPageChange(t){this.page=t.pageIndex,this.pageSize=t.pageSize,this.fetch()}doSearch(){this.page=0,this.paginator.pageIndex=0,this.fetch()}clearSearchForm(){this.queryStartDate=void 0,this.queryEndDate=void 0,this.selectedForm=void 0,this.searchWord="",this.page=0,this.filteredForm=this.forms,this.fetch()}sortData(t){const e=this.res.slice();this.sort=t,this.dataSource=t.active&&""!==t.direction?e.sort((e,i)=>{const n="asc"===t.direction;switch(t.active){case"user_id":return Tt(e.user_id,i.user_id,n);case"user_name":return Tt(e.user_name,i.user_name,n);case"role":return Tt(e.role,i.role,n);case"in_timestamp":return Tt(e.in_timestamp,i.in_timestamp,n);case"in_submitted_date":return Tt(e.in_submitted_date,i.in_submitted_date,n);case"in_temp":return Tt(e.in_temp,i.in_temp,n);default:return 0}}):e}editForm(t){let e=[];this.formService.selectedId=t._id,e=this.hasTemplateType?["../device-class",t.productionLine,t.workstationForm,"edit"]:["../type",t.productionLine,t.workstationForm,"edit"],this.router.navigate(e,{relativeTo:this.activatedRoute})}highlight(t){t>=0&&t<=this.res.length-1&&(this.selectedRowIndex=t)}arrowUpEvent(t){this.highlight(t-1)}arrowDownEvent(t){this.highlight(t+1)}selectFormByIndex(t){(t=this.res[t])&&this.editForm(t)}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(L.a),s.Ob(D),s.Ob(F.a),s.Ob(a.h),s.Ob(k.a),s.Ob(a.a))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-form-history"]],viewQuery:function(t,e){var i;1&t&&s.Qc(O,!0),2&t&&s.tc(i=s.dc())&&(e.paginator=i.first)},features:[s.Bb([{provide:h.c,useClass:I.c,deps:[h.f,I.a]},{provide:h.e,useValue:ft}])],decls:51,vars:35,consts:[["id","contacts","fusePerfectScrollbar","",1,"page-layout","simple","fullwidth"],["fxLayout","column","fxLayoutAlign","center center","fxLayout.gt-sm","row","fxLayoutAlign.gt-sm","space-between center",1,"header","accent","p-24"],["fxLayout","row","fxLayoutAlign","start center",1,"logo","mb-24","mb-md-0"],[1,"logo-icon","s-32","mr-16"],[1,"logo-text","h1"],[1,"search-wrapper","mx-32","mx-md-0"],[1,"m-24","mb-0",3,"expanded"],["fxLayout","column"],["fxLayout","row","fxFlex",""],[1,"search-wrapper","mt-16","mt-sm-0"],["fxFlex","","fxLayout","row","fxLayoutAlign","start center",1,"search"],["matInput","","id","searchInput",3,"ngModel","placeholder","matAutocomplete","ngModelChange"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["fxLayout","row",2,"margin-top","1%"],["appearance","outline",2,"width","100%"],[3,"rangePicker"],["tabindex","-1","readonly","","matStartDate","",3,"ngModel","placeholder","ngModelChange"],["tabindex","-1","readonly","","matEndDate","",3,"ngModel","placeholder","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["type","button","mat-raised-button","","color","primary",3,"click"],["type","button","mat-raised-button","","color","default",3,"click"],[1,"content","p-24","pt-1"],["fusePerfectScrollbar","",1,"center"],["class","content",4,"ngIf"],[3,"value"],[4,"ngIf"],[1,"content"],["matSort","",3,"dataSource","matSortChange","focusin","focusout"],["table",""],["matColumnDef","date"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","line"],["matColumnDef","form"],[4,"matHeaderRowDef"],["class","highlight",3,"background","tabindex","click","keydown.enter","keydown.arrowdown","keydown.arrowup",4,"matRowDef","matRowDefColumns"],[3,"pageIndex","length","pageSize","pageSizeOptions","page"],["paginator",""],["mat-sort-header",""],[1,"text-truncate","font-weight-600",3,"click"],[1,"highlight",3,"tabindex","click","keydown.enter","keydown.arrowdown","keydown.arrowup"],[3,"matColumnDef",4,"ngFor","ngForOf"],[3,"length","pageSize","pageSizeOptions","page"],[3,"matColumnDef"],[4,"ngFor","ngForOf"],["class","text-breakword font-weight-600",3,"click",4,"ngIf"],["class","text-truncate font-weight-600",3,"click",4,"ngIf"],[1,"text-breakword","font-weight-600",3,"click"]],template:function(t,e){if(1&t&&(s.Ub(0,"div",0),s.Ub(1,"div",1),s.Ub(2,"div",2),s.Ub(3,"mat-icon",3),s.Lc(4," history "),s.Tb(),s.Ub(5,"span",4),s.Lc(6),s.hc(7,"translate"),s.Tb(),s.Tb(),s.Pb(8,"div",5),s.Tb(),s.Ub(9,"mat-expansion-panel",6),s.Ub(10,"mat-expansion-panel-header"),s.Ub(11,"mat-panel-title"),s.Lc(12),s.hc(13,"translate"),s.Tb(),s.Tb(),s.Ub(14,"div",7),s.Ub(15,"div",8),s.Ub(16,"div",9),s.Ub(17,"div",10),s.Ub(18,"mat-icon"),s.Lc(19,"search"),s.Tb(),s.Ub(20,"input",11),s.cc("ngModelChange",(function(t){return e.searchWord=t}))("ngModelChange",(function(t){return e.filterMyOptions(t)})),s.hc(21,"translate"),s.Tb(),s.Ub(22,"mat-autocomplete",12,13),s.cc("optionSelected",(function(t){return e.selectForm(t.option.value)})),s.Jc(24,j,3,3,"mat-option",14),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Ub(25,"div",15),s.Ub(26,"mat-form-field",16),s.Ub(27,"mat-label"),s.Lc(28),s.hc(29,"translate"),s.Tb(),s.Ub(30,"mat-date-range-input",17),s.Ub(31,"input",18),s.cc("ngModelChange",(function(t){return e.queryStartDate=t})),s.hc(32,"translate"),s.Tb(),s.Ub(33,"input",19),s.cc("ngModelChange",(function(t){return e.queryEndDate=t})),s.hc(34,"translate"),s.Tb(),s.Tb(),s.Pb(35,"mat-datepicker-toggle",20),s.Pb(36,"mat-date-range-picker",null,21),s.Tb(),s.Tb(),s.Tb(),s.Lc(38," \xa0 "),s.Pb(39,"br"),s.Ub(40,"button",22),s.cc("click",(function(){return e.doSearch()})),s.Lc(41),s.hc(42,"translate"),s.Tb(),s.Lc(43," \xa0 "),s.Ub(44,"button",23),s.cc("click",(function(){return e.clearSearchForm()})),s.Lc(45),s.hc(46,"translate"),s.Tb(),s.Tb(),s.Ub(47,"div",24),s.Ub(48,"div",25),s.Jc(49,it,17,9,"div",26),s.Jc(50,mt,8,9,"div",26),s.Tb(),s.Tb(),s.Tb()),2&t){const t=s.uc(23),i=s.uc(37);s.Cb(6),s.Nc(" ",s.ic(7,19,"FORM_HISTORY.SUBMISSION_HISTORY")," "),s.Cb(3),s.nc("expanded",!0),s.Cb(3),s.Nc(" ",s.ic(13,21,"FORM_HISTORY.SEARCH")," "),s.Cb(8),s.oc("placeholder",s.ic(21,23,"FORM_HISTORY.SEARCH_FOR_FORM")),s.nc("ngModel",e.searchWord)("matAutocomplete",t),s.Cb(2),s.nc("displayWith",e.displayWith),s.Cb(2),s.nc("ngForOf",e.filteredForm),s.Cb(4),s.Mc(s.ic(29,25,"FORM_HISTORY.DATE_RANGE")),s.Cb(2),s.nc("rangePicker",i),s.Cb(1),s.oc("placeholder",s.ic(32,27,"FORM_HISTORY.START_DATE")),s.nc("ngModel",e.queryStartDate),s.Cb(2),s.oc("placeholder",s.ic(34,29,"FORM_HISTORY.END_DATE")),s.nc("ngModel",e.queryEndDate),s.Cb(2),s.nc("for",i),s.Cb(6),s.Mc(s.ic(42,31,"Search")),s.Cb(4),s.Mc(s.ic(46,33,"Clear")),s.Cb(4),s.nc("ngIf",!e.dynamicTable),s.Cb(1),s.nc("ngIf",e.dynamicTable)}},directives:[U.a,R.c,R.b,E.a,A.c,A.e,A.f,R.a,N.d,B.c,N.s,N.v,B.a,n.s,b.c,b.g,H.d,H.l,H.k,H.j,b.i,H.e,r.b,n.t,h.o,J.j,J.c,J.e,J.b,J.g,J.i,O,J.d,J.a,J.f,J.h],pipes:[Y.c,n.f,n.E],styles:["#contacts[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]{width:100%;max-width:480px;border-radius:28px;overflow:hidden;box-shadow:0 2px 1px -1px rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 1px 3px 0 rgba(0,0,0,.12)}#contacts[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{width:100%;height:48px;line-height:48px;padding:0 18px}#contacts[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:48px;min-height:48px;max-height:48px;padding:0 16px;border:none;outline:none}#contacts[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{overflow:hidden}#contacts[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]:not(.locked-open){background:#fff}#contacts[_ngcontent-%COMP%]   .text-breakword[_ngcontent-%COMP%]{word-wrap:break-word}.highlight[_ngcontent-%COMP%]:hover{background:#f5f5f5;cursor:pointer}.search-wrapper[_ngcontent-%COMP%]{background-color:#fff;width:100%;max-width:480px;border-radius:28px;overflow:hidden;box-shadow:0 2px 1px -1px rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 1px 3px 0 rgba(0,0,0,.12)}.search-wrapper[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{width:100%;height:48px;line-height:48px;padding:0 18px}.search-wrapper[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:48px;min-height:48px;max-height:48px;padding:0 16px;border:none;outline:none}"]}),t})();function Tt(t,e,i){return(t<e?-1:1)*(i?1:-1)}var St=i("Wp6s"),xt=i("MutI"),_t=i("5HBU");const wt=[{path:"",component:yt}];let Ct=(()=>{class t{}return t.\u0275mod=s.Mb({type:t}),t.\u0275inj=s.Lb({factory:function(e){return new(e||t)},imports:[[a.l.forChild(wt),n.c,Y.b,l.b,b.e,E.b,St.d,B.b,xt.c,J.l,_t.a,P,A.b,r.c,H.i,N.n]]}),t})()}}]);